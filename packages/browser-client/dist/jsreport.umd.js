!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e||self).jsreport=t()}(this,function(){function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.apply(this,arguments)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=function(e){var t={exports:{}};return function(e,t){!function(){function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){a(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,s=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||("object"!=typeof window||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,r,s){var a=i.URL||i.webkitURL,u=document.createElement("a");u.download=r=r||e.name||"download",u.rel="noopener","string"==typeof e?(u.href=e,u.origin===location.origin?o(u):n(u.href)?t(e,r,s):o(u,u.target="_blank")):(u.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(u.href)},4e4),setTimeout(function(){o(u)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,i){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,i),r);else if(n(e))t(e,r,i);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){o(s)})}}:function(e,n,r,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,r);var a="application/octet-stream"===e.type,u=/constructor/i.test(i.HTMLElement)||i.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&u||s)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},c.readAsDataURL(e)}else{var f=i.URL||i.webkitURL,p=f.createObjectURL(e);o?o.location=p:location.href=p,o=null,setTimeout(function(){f.revokeObjectURL(p)},4e4)}});i.saveAs=a.saveAs=a,e.exports=a}()}(t),t.exports}();function i(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var s=/*#__PURE__*/function(){function e(e){this._response=e}var t,n,r=e.prototype;return r.toString=function(){try{return Promise.resolve(this.response.blob()).then(function(e){return e.text()})}catch(e){return Promise.reject(e)}},r.download=function(e){try{return Promise.resolve(this.response.blob()).then(function(t){o.saveAs(t,e)})}catch(e){return Promise.reject(e)}},r.toBlob=function(){try{return Promise.resolve(this.response.blob())}catch(e){return Promise.reject(e)}},r.toDataURI=function(){try{var e=new FileReader;return Promise.resolve(this.response.blob()).then(function(t){return new Promise(function(n){e.onload=function(t){n(e.result)},e.readAsDataURL(t)})})}catch(e){return Promise.reject(e)}},r.openInWindow=function(e){var t=void 0===e?{}:e,n=t.cleanInterval,r=void 0===n?5e3:n,o=t.windowName,i=t.windowFeatures,s=t.title;try{return Promise.resolve(this.response.blob()).then(function(e){var t=URL.createObjectURL(e,o,i),n=window.URL.createObjectURL(new Blob(["\n    <html>\n      <head>\n        <title>"+(s||"report")+'</title>\n        <style>\n          html, body {\n            margin: 0px;\n            width: 100%;\n            height: 100%;\n          }\n        </style>\n      </head>\n      <body>\n        <iframe src="'+t+'" frameborder="0" width="100%" height="100%" />\n      </body>\n    </html>\n  '],{type:"text/html"})),a=window.open(n),u=setInterval(function(){a&&a.closed&&(URL.revokeObjectURL(t),URL.revokeObjectURL(n),clearInterval(u))},r);return a})}catch(e){return Promise.reject(e)}},r.toObjectURL=function(){try{return Promise.resolve(this.response.blob()).then(URL.createObjectURL)}catch(e){return Promise.reject(e)}},t=e,(n=[{key:"response",get:function(){return this._response}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),a=/*#__PURE__*/function(){function t(){this.headers={}}var r=t.prototype;return r._normalizeUrl=function(e){for(var t,r=new URL(e),o=[],i=n([].slice.call(arguments,1));!(t=i()).done;){var s=t.value,a=s;"/"===a[0]&&(a=a.slice(1)),"/"===a[a.length-1]&&(a=a.slice(0,-1)),""!==a&&o.push(a)}if(0===o.length)return r.toString();var u="/"===r.pathname[r.pathname.length-1]?r.pathname.slice(0,-1):r.pathname;return o.unshift(u),new URL(o.join("/"),r).toString()},r._jsreportRequest=function(t){var n=t.method,r=t.path,o=t.body;try{var s=function(t){var n=function(){if(!u.ok){var t=function(){var e=new Error(n.message);throw Object.assign(e,{status:u.status,statusText:u.statusText,error:n}),e},n={message:"jsreport server responded with error. status text: "+u.statusText+", status code: "+u.status},r=i(function(){return Promise.resolve(u.blob()).then(function(t){return Promise.resolve(t.text()).then(function(t){var r=JSON.parse(t);n=e({},r,{message:n.message+", details: "+r.message})})})},function(){});return r&&r.then?r.then(t):t()}}();return n&&n.then?n.then(function(e){return u}):u},a=this;if(!a.serverUrl)throw new Error("The script was not linked from jsreport. You need to fill jsreport.serverUrl property with valid url to jsreport server.");var u,l=a._normalizeUrl(a.serverUrl,r),c=i(function(){return Promise.resolve(fetch(l,{headers:e({"Content-Type":"application/json"},a.headers),body:null!=o?JSON.stringify(o):null,method:n})).then(function(e){u=e})},function(){throw new Error("Failed to connect to jsreport server.")});return Promise.resolve(c&&c.then?c.then(s):s())}catch(e){return Promise.reject(e)}},r._submitFormRequest=function(e,t,n){var r=document.createElement("form");r.target=t,r.id=(new Date).getTime(),r.method="POST",r.action=this._normalizeUrl(this.serverUrl,"/api/report",encodeURIComponent(n));var o=document.createElement("input");o.type="hidden",o.name="renderRequestContent",o.value=JSON.stringify(e),r.appendChild(o),document.body.appendChild(r),function e(t){if(t>10)return console.log("Unable to submit render form.");try{r.submit(),r.outerHTML=""}catch(n){setTimeout(function(){e(t+1)},50)}}(0)},r.download=function(e,t){if(null==e||"string"!=typeof e||""===e.trim())throw new Error("jsreport.download requires filename parameter and must be a non empty string");var n=Object.assign({},t);n.options=Object.assign({},n.options),null==n.options["Content-Disposition"]&&(n.options["Content-Disposition"]='attachment; filename="'+e+'"'),this._submitFormRequest(n,"_self",e)},r.openInWindow=function(e,t){var n=void 0===e?{}:e,r=n.title,o=n.filename;if(null==r||"string"!=typeof r||""===r.trim())throw new Error("jsreport.openInWindow requires title parameter and must be a non empty string");if(null==o||"string"!=typeof o||""===o.trim())throw new Error("jsreport.openInWindow requires filename parameter and must be a non empty string");var i=Object.assign({},t);o&&(i.options=Object.assign({},i.options),null==i.options["Content-Disposition"]&&(i.options["Content-Disposition"]='inline; filename="'+o+'"')),this._submitFormRequest(i,"_blank",r)},r.render=function(e){try{return Promise.resolve(this._jsreportRequest({method:"POST",path:"/api/report",body:e})).then(function(e){return new s(e)})}catch(e){return Promise.reject(e)}},r.createClient=function(){return new t},t}(),u=new a;return setTimeout(function(){void 0!==window.jsreportInit&&jsreportInit(u)},0),u});
//# sourceMappingURL=jsreport.umd.js.map
